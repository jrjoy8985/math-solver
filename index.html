<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8">
  <title>JoyMath Solver</title>
  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@2.1.1/dist/tesseract.min.js"></script>
  <style>
    body {
      font-family: "Segoe UI", sans-serif;
      background: #eef9ff;
      padding: 20px;
      text-align: center;
    }
    h1 {
      color: #007acc;
    }
    input[type="file"], textarea, button {
      margin: 10px;
      padding: 10px;
      font-size: 16px;
    }
    textarea {
      width: 90%;
      max-width: 600px;
      height: 80px;
      border-radius: 10px;
      border: 1px solid #ccc;
    }
    .output {
      background: white;
      padding: 15px;
      border-radius: 10px;
      margin: 15px auto;
      max-width: 600px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      white-space: pre-wrap;
    }
    .pill {
      background-color: #d0f0ff;
      color: #0077aa;
      padding: 6px 14px;
      border-radius: 999px;
      margin: 6px;
      display: inline-block;
      font-size: 14px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
  </style>
</head>
<body>
  <h1>ЁЯУ╕тЬНя╕П JoyMath Solver</h1>
  <p>ржЫржмрж┐ ржЖржкрж▓рзЛржб ржХрж░рзБржи ржЕржержмрж╛ ржирж┐ржЬрзЗ рж▓рж┐ржЦрзБржи (ржмрж╛ржВрж▓рж╛/English)</p>

  <input type="file" id="imageInput" accept="image/*"><br>

  <textarea id="manualInput" placeholder="ржПржЦрж╛ржирзЗ ржорзНржпрж╛рже рж▓рж┐ржЦрзБржи ржпрзЗржоржиржГ ржЧрждрж┐ = ржжрзВрж░рждрзНржм / рж╕ржорзЯ ржмрж╛ F = ma"></textarea><br>

  <button onclick="processManualInput()">тЬНя╕П Solve Typed Math</button>

  <div class="output" id="output">ЁЯУЛ ржлрж▓рж╛ржлрж▓ ржПржЦрж╛ржирзЗ ржЖрж╕ржмрзЗ...</div>
  <div id="suggestions"></div>

  <script>
    const imageInput = document.getElementById("imageInput");
    const output = document.getElementById("output");
    const suggestionsDiv = document.getElementById("suggestions");

    const formulas = {
      'ржЧрждрж┐': ['ржЧрждрж┐ = ржжрзВрж░рждрзНржм / рж╕ржорзЯ', 'ржЧрждрж┐ = ╧Й ├Ч r'],
      'ржмрж▓': ['ржмрж▓ = ржнрж░ ├Ч рждрзНржмрж░ржг', 'F = ma'],
      'рждрзНрж░рж┐ржнрзБржЬ': ['рждрзНрж░рж┐ржнрзБржЬрзЗрж░ ржХрзНрж╖рзЗрждрзНрж░ржлрж▓ = ┬╜ ├Ч base ├Ч height'],
      'ржнрж░': ['ржнрж░ = ржУржЬржи / ржорж╛ржзрзНржпрж╛ржХрж░рзНрж╖ржг'],
      'force': ['F = ma', 'F = G * (m1*m2)/r┬▓'],
      'speed': ['Speed = Distance / Time'],
      'area': ['Area = ╧Аr┬▓', 'Area = length ├Ч width']
    };

    function suggestFormulas(text) {
      suggestionsDiv.innerHTML = '';
      for (let key in formulas) {
        if (text.toLowerCase().includes(key)) {
          formulas[key].forEach(f => {
            const span = document.createElement("span");
            span.className = "pill";
            span.innerText = f;
            suggestionsDiv.appendChild(span);
          });
        }
      }
    }

    function trySolveMath(text) {
      try {
        const mathText = text.replace(/[^\d\+\-\*\/\.\(\)]/g, '');
        if (mathText) {
          const result = eval(mathText);
          return `${mathText} = ${result}`;
        }
      } catch (e) {
        return "тЪая╕П рж╕ржорж╛ржзрж╛ржи ржХрж░рж╛ ржпрж╛рзЯржирж┐ред";
      }
      return '';
    }

    imageInput.addEventListener("change", () => {
      const file = imageInput.files[0];
      output.innerText = "тП│ ржЫржмрж┐ ржкрзНрж░рж╕рзЗрж╕ ржХрж░рж╛ рж╣ржЪрзНржЫрзЗ...";
      suggestionsDiv.innerHTML = "";

      Tesseract.recognize(file, 'eng+ben', {
        logger: m => console.log(m)
      }).then(({ data: { text } }) => {
        output.innerText = "ЁЯУД ржЪрж┐рж╣рзНржирж┐ржд рж▓рзЗржЦрж╛:\n" + text;
        suggestFormulas(text);
        const result = trySolveMath(text);
        if (result) output.innerText += `\n\nЁЯУШ рж╕ржорж╛ржзрж╛ржи:\n${result}`;
      });
    });

    function processManualInput() {
      const text = document.getElementById("manualInput").value;
      output.innerText = "ЁЯУД ржЗржиржкрзБржЯ рж▓рзЗржЦрж╛:\n" + text;
      suggestFormulas(text);
      const result = trySolveMath(text);
      if (result) output.innerText += `\n\nЁЯУШ рж╕ржорж╛ржзрж╛ржи:\n${result}`;
    }
  </script>
</body>
</html>
